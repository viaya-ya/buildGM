"use strict";(self.webpackChunkgood_management=self.webpackChunkgood_management||[]).push([[407],{1268:(e,a,t)=>{t.d(a,{A:()=>d});t(5043);const r={editText:"BottomHeaders_editText__6e9Ca"},s={wrapper:"ButtonAction_wrapper__YWbBU"};var n=t(3732),o=t(4530),c=t(9307),i=t(579);function l(e){let{create:a,update:t,refUpdate:r,refCreate:l}=e;return(0,i.jsxs)("div",{className:s.wrapper,children:[a&&(0,i.jsx)(c.A,{refAction:l,name:"\u0441\u043e\u0437\u0434\u0430\u0442\u044c",icon:n.A,onClick:a}),t&&(0,i.jsx)(c.A,{refAction:r,name:"\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c",icon:o.A,onClick:t})]})}function d(e){let{children:a,create:t,update:s,refUpdate:n,refCreate:o}=e;return(0,i.jsxs)("div",{className:r.editText,children:[a,(0,i.jsx)(l,{create:t,update:s,refUpdate:n,refCreate:o})]})}},6407:(e,a,t)=>{t.r(a),t.d(a,{default:()=>B});var r=t(9379),s=t(5043);const n={dialog:"User_dialog__JvQe3",main:"User_main__ibuEy",block:"User_block__-PgfL",column2:"User_column2__sXh-e",avatarContainer:"User_avatarContainer__bneNb",avatar:"User_avatar__gUSWO",hiddenInput:"User_hiddenInput__qby9C",btnSave:"User_btnSave__DbKIr"};var o=t(7422),c=t(1268),i=t(917),l=t(4457),d=t.n(l),h=t(8877),u=t(6537),m=t(9048),x=t(1488),p=t(9482),v=t(8048);const _={modal:"ModalSelectCheckBox_modal__++GYJ",modalWindow:"ModalSelectCheckBox_modalWindow__YexkJ",header:"ModalSelectCheckBox_header__ChWcU",item1:"ModalSelectCheckBox_item1__5Eh7N",item2:"ModalSelectCheckBox_item2__PRtzx",search:"ModalSelectCheckBox_search__5mi+6",exit:"ModalSelectCheckBox_exit__mf2sM",table:"ModalSelectCheckBox_table__Sz7YQ",row:"ModalSelectCheckBox_row__qMiZu"};var C=t(7583),j=t(4530),g=t(9307),S=t(579);function k(e){let{nameTable:a,handleSearchValue:t,handleSearchOnChange:r,exit:s,filterArray:n,array:o,arrayItem:c,save:i,handleChecboxChange:l,arrayChecked:d,nameBtn:h,iconBtn:u}=e;return(0,S.jsx)("div",{className:_.modal,children:(0,S.jsxs)("div",{className:_.modalWindow,children:[(0,S.jsx)("img",{src:C.A,alt:"exitModal",onClick:()=>s(),className:_.exit}),(0,S.jsxs)("div",{className:_.header,children:[(0,S.jsx)("div",{className:_.item1,children:(0,S.jsx)("input",{type:"search",placeholder:"\u041d\u0430\u0439\u0442\u0438",value:t,onChange:r,className:_.search})}),i&&(0,S.jsx)("div",{className:_.item2,children:(0,S.jsx)(g.A,{name:h||"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",icon:u||j.A,onClick:i})})]}),(0,S.jsxs)("table",{className:_.table,children:[(0,S.jsx)("thead",{children:(0,S.jsx)("tr",{children:(0,S.jsx)("th",{children:a})})}),n.length>0?(0,S.jsx)("tbody",{children:(0,S.jsx)("tr",{children:(0,S.jsx)("td",{children:null===n||void 0===n?void 0:n.map((e=>(0,S.jsxs)("div",{className:_.row,onClick:()=>l(e.id,e),children:[(0,S.jsx)("input",{type:"checkbox",checked:null===d||void 0===d?void 0:d.includes(e.id)}),e[c]]},e.id)))})})}):(0,S.jsx)("tbody",{children:(0,S.jsx)("tr",{children:(0,S.jsx)("td",{children:null===o||void 0===o?void 0:o.map((e=>(0,S.jsxs)("div",{className:_.row,onClick:()=>l(e.id,e),children:[(0,S.jsx)("input",{type:"checkbox",checked:null===d||void 0===d?void 0:d.includes(e.id)}),e[c]]},e.id)))})})})]})]})})}var f=t(5803),A=t(3732),y=t(3216),N=t(3003),b=t(6908),U=t(839),w=t(4863),M=t(4293);function B(){var e,a,t,l,_;const[C,j]=(0,s.useState)(""),[g,B]=(0,s.useState)(""),[I,E]=(0,s.useState)(""),[L,O]=(0,s.useState)(""),[P,z]=(0,s.useState)(!1),[q,R]=(0,s.useState)(""),[W,J]=(0,s.useState)(""),[T,Z]=(0,s.useState)(""),[Y,D]=(0,s.useState)([]),[G,F]=(0,s.useState)([]),[H,Q]=(0,s.useState)(!1),V=[{title:"\u0410\u0432\u0430\u0442\u0430\u0440",description:"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440 \u0438 \u043f\u043e\u043c\u0435\u043d\u044f\u0439\u0442\u0435 \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044e, \u043f\u0440\u0438 \u043d\u0430\u0436\u0430\u0442\u0438\u0438 \u043d\u0430 \u043a\u0440\u0435\u0441\u0442\u0438\u043a \u0430\u0432\u0430\u0442\u0430\u0440 \u0443\u0434\u0430\u043b\u0438\u0442\u044c\u0441\u044f",target:()=>document.querySelector('[data-tour="data-avatar"]')},{title:"\u041b\u0438\u0447\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f",description:"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u043f\u043e\u043b\u044f \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",target:()=>document.querySelector('[data-tour="data-form"]')},{title:"\u041f\u043e\u0441\u0442",description:"\u0417\u0434\u0435\u0441\u044c \u043c\u043e\u0436\u0435\u0442\u0435 \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u043b\u0438 \u043f\u0440\u0438\u043a\u0440\u0435\u043f\u0438\u0442\u044c \u043f\u043e\u0441\u0442 \u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e",target:()=>document.querySelector('[data-tour="data-post"]')},{title:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",description:"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0434\u043b\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f",target:()=>document.querySelector('[data-tour="data-save"]')}],{reduxSelectedOrganizationId:K,postUser:X,isLoadingUserMutation:$,isSuccessUserMutation:ee,isErrorUserMutation:ae,ErrorUserMutation:te,localIsResponseUserMutation:re,postsWithoutUser:se,isLoadingGetUserNew:ne,isErrorGetUserNew:oe}=(0,h.I1)(),[ce]=(0,m.M$)(),ie=(0,N.wA)(),le=async()=>{const e={firstName:C,lastName:g,middleName:I,telephoneNumber:L,organizationId:K};if(W){const t=new FormData;t.append("file",W);try{const a=await ce(t).unwrap();e.avatar_url=a.filePath}catch(a){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f:",JSON.stringify(a,null,2))}}try{const a=await X(e).unwrap();Se(),ge(a.id),ie((0,b.Nz)(a.id))}catch(a){Se(),console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f:",JSON.stringify(a,null,2))}},de=(0,s.useRef)(null),{filterArraySearchModalCheckBox:he,handleCheckboxChange:ue,inputSearchModalCheckBox:me,setInputSearchModalCheckBox:xe}=(0,h.MF)({array:se,arrayItem:"postName",setArrayChecked:D}),{updatePost:pe,isLoadingUpdatePostMutation:ve,isSuccessUpdatePostMutation:_e,isErrorUpdatePostMutation:Ce,ErrorUpdatePostMutation:je}=(0,h.es)(),ge=async e=>{if(Y.length>0&&e)try{await Promise.all(Y.map((async a=>{await pe({_id:a,responsibleUserId:e}).unwrap().then((()=>{Se()})).catch((e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u043f\u043e\u0441\u0442\u0430 ".concat(a,":"),JSON.stringify(e,null,2))}))})))}catch(a){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432:",a)}},Se=()=>{j(""),B(""),E(""),O(""),R(""),J(""),D([]),F([])};(0,s.useEffect)((()=>{C&&g&&I&&12==L.length?z(!0):z(!1)}),[C,g,I,L]);const ke=(0,y.Zp)();return(0,S.jsxs)("div",{className:n.dialog,children:[(0,S.jsx)(o.A,{name:"\u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",funcActiveHint:()=>Q(!0),children:(0,S.jsx)(c.A,{})}),(0,S.jsx)(U.Ay,{locale:M.A,children:(0,S.jsx)(w.A,{open:H,onClose:()=>Q(!1),steps:V})}),(0,S.jsxs)("div",{className:n.main,children:[(0,S.jsxs)("div",{className:n.block,children:[(0,S.jsxs)("div",{className:n.avatarContainer,"data-tour":"data-avatar",children:[(0,S.jsx)("img",{src:q||x.A,alt:"avatar",className:n.avatar,onClick:()=>{de.current.click()}}),(0,S.jsx)("input",{type:"file",accept:"image/*",ref:de,className:n.hiddenInput,onChange:e=>{const a=e.target,t=e.target.files[0];if(t){J(t);const e=URL.createObjectURL(t);R(e)}a.value=""}}),(0,S.jsx)("img",{src:f.A,title:"\u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",onClick:()=>{q&&URL.revokeObjectURL(q),J(""),R("")},style:{width:"12px",height:"12px"}})]}),(0,S.jsxs)("div",{className:n.column2,children:[(0,S.jsxs)("div",{"data-tour":"data-form",className:n.column2,children:[(0,S.jsx)(i.A,{name:"\u0418\u043c\u044f",value:C,onChange:e=>{const a=e.replace(/[^A-Za-z\u0410-\u042f\u0430-\u044f\s]/g,""),t=a.charAt(0).toUpperCase()+a.slice(1);j(t)}}),(0,S.jsx)(i.A,{name:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",value:g,onChange:e=>{const a=e.replace(/[^A-Za-z\u0410-\u042f\u0430-\u044f\s]/g,""),t=a.charAt(0).toUpperCase()+a.slice(1);B(t)}}),(0,S.jsx)(i.A,{name:"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e",value:I,onChange:e=>{const a=e.replace(/[^A-Za-z\u0410-\u042f\u0430-\u044f\s]/g,""),t=a.charAt(0).toUpperCase()+a.slice(1);E(t)}}),(0,S.jsx)(i.A,{name:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",isShowInput:!0,children:(0,S.jsx)(d(),{mask:"+9 (999) 999-99-99",value:L,onChange:e=>{const a=e.target.value.replace(/\D/g,"");O("+".concat(a))},placeholder:"+9 (999) 999-99-99",required:!0,children:e=>(0,S.jsx)("input",(0,r.A)((0,r.A)({},e),{},{type:"tel",id:"phone"}))})})]}),(0,S.jsx)(v.A,{dataTour:"data-post",image:p.A,onClick:()=>Z(!0),selectArray:G,prefix:"\u041f\u043e\u0441\u0442\u044b: ",btnName:"\u041f\u0438\u043a\u0440\u0435\u043f\u0438\u0442\u044c \u043f\u043e\u0441\u0442\u044b",disabled:!P}),T&&(0,S.jsx)(k,{nameTable:"\u041f\u043e\u0441\u0442\u044b",handleSearchValue:me,handleSearchOnChange:e=>xe(e.target.value),exit:()=>{Z(!1);const e=Y.map((e=>{var a;return null===(a=se.find((a=>e===a.id)))||void 0===a?void 0:a.postName})).filter(Boolean);F(e)},filterArray:he,array:se,arrayItem:"postName",handleChecboxChange:ue,arrayChecked:Y,save:async()=>{try{await le(),ke("/pomoshnik/postNew")}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f:",e)}},nameBtn:"\u0441\u043e\u0437\u0434\u0430\u0442\u044c",iconBtn:A.A}),(0,S.jsx)("button",{"data-tour":"data-save",onClick:le,className:n.btnSave,disabled:!P,children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]}),(0,S.jsx)(u.A,{Loading:$,Error:ae&&re,Success:ee&&re,textSuccess:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c ".concat(C," ").concat(g," ").concat(I," \u0441\u043e\u0437\u0434\u0430\u043d"),textError:null!==te&&void 0!==te&&null!==(e=te.data)&&void 0!==e&&null!==(a=e.errors)&&void 0!==a&&null!==(t=a[0])&&void 0!==t&&null!==(l=t.errors)&&void 0!==l&&l[0]?te.data.errors[0].errors[0]:null===te||void 0===te||null===(_=te.data)||void 0===_?void 0:_.message})]})]})}}}]);
//# sourceMappingURL=407.84869a36.chunk.js.map