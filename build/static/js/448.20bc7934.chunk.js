"use strict";(self.webpackChunkgood_management=self.webpackChunkgood_management||[]).push([[448],{543:(e,t,a)=>{a.d(t,{A:()=>l});a(5043);const l=a.p+"static/media/statisticsArrowLeft.cf19db7109d7a471f9a4757f06f848cb.svg"},3066:(e,t,a)=>{a.d(t,{A:()=>l});a(5043);const l=a.p+"static/media/statisticsArrowRight.49741dd1d1342ed4af242f97a798956a.svg"},1268:(e,t,a)=>{a.d(t,{A:()=>d});a(5043);const l={editText:"BottomHeaders_editText__6e9Ca"},r={wrapper:"ButtonAction_wrapper__YWbBU"};var n=a(3732),o=a(4530),i=a(9307),s=a(579);function c(e){let{create:t,update:a,refUpdate:l,refCreate:c}=e;return(0,s.jsxs)("div",{className:r.wrapper,children:[t&&(0,s.jsx)(i.A,{refAction:c,name:"\u0441\u043e\u0437\u0434\u0430\u0442\u044c",icon:n.A,onClick:t}),a&&(0,s.jsx)(i.A,{refAction:l,name:"\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c",icon:o.A,onClick:a})]})}function d(e){let{children:t,create:a,update:r,refUpdate:n,refCreate:o}=e;return(0,s.jsxs)("div",{className:l.editText,children:[t,(0,s.jsx)(c,{create:a,update:r,refUpdate:n,refCreate:o})]})}},6378:(e,t,a)=>{a.d(t,{A:()=>o});a(5043);const l={modalDelete:"ModalWindow_modalDelete__6F2XA",modalDeleteElement:"ModalWindow_modalDeleteElement__BWKSd",modalRow1:"ModalWindow_modalRow1__lAjGg",modalRow2:"ModalWindow_modalRow2__s2-a6",btnYes:"ModalWindow_btnYes__ScZrA",btnNo:"ModalWindow_btnNo__q5w-4",textBtnYes:"ModalWindow_textBtnYes__nsbep",textBtnNo:"ModalWindow_textBtnNo__3q10K",text:"ModalWindow_text__LCc-R",exitImage:"ModalWindow_exitImage__OFdfY"};var r=a(7583),n=a(579);function o(e){let{text:t,close:a,btnYes:o,btnNo:i,exitBtn:s}=e;return(0,n.jsx)("div",{className:l.modalDelete,children:(0,n.jsxs)("div",{className:l.modalDeleteElement,children:[(0,n.jsx)("img",{src:r.A,alt:"exit",className:l.exitImage,onClick:()=>a(!1)}),(0,n.jsx)("div",{className:l.modalRow1,children:(0,n.jsx)("span",{className:l.text,children:t})}),!s&&(0,n.jsxs)("div",{className:l.modalRow2,children:[(0,n.jsx)("button",{className:"".concat(l.btnYes," ").concat(l.textBtnYes),onClick:o,children:"\u0414\u0430"}),(0,n.jsx)("button",{className:"".concat(l.btnNo," ").concat(l.textBtnNo),onClick:i,children:"\u041d\u0435\u0442"})]})]})})}},7321:(e,t,a)=>{a.d(t,{$:()=>s});a(5043);const l={modal:"ModalSelectRadio_modal__nPGHn",modalWindow:"ModalSelectRadio_modalWindow__dncJU",header:"ModalSelectRadio_header__DW8xM",item1:"ModalSelectRadio_item1__QmdXG",item2:"ModalSelectRadio_item2__Hm1w9",search:"ModalSelectRadio_search__uW77Q",exit:"ModalSelectRadio_exit__BO5fc",table:"ModalSelectRadio_table__nysW+",row:"ModalSelectRadio_row__F5ykw"};var r=a(7583),n=a(4530),o=a(9307),i=a(579);function s(e){let{nameTable:t,handleSearchValue:a,handleSearchOnChange:s,exit:c,filterArray:d,array:u,arrayItem:v,selectedItemID:m,handleRadioChange:g,save:p}=e;return(0,i.jsx)("div",{className:l.modal,children:(0,i.jsxs)("div",{className:l.modalWindow,children:[(0,i.jsx)("img",{src:r.A,alt:"exitModal",onClick:()=>c(),className:l.exit}),(0,i.jsxs)("div",{className:l.header,children:[(0,i.jsx)("div",{className:l.item1,children:(0,i.jsx)("input",{type:"search",placeholder:"\u041d\u0430\u0439\u0442\u0438",value:a,onChange:s,className:l.search})}),p&&(0,i.jsx)("div",{className:l.item2,children:(0,i.jsx)(o.A,{name:"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",icon:n.A,onClick:p})})]}),(0,i.jsxs)("table",{className:l.table,children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("th",{children:t})})}),d.length>0?(0,i.jsx)("tbody",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{children:null===d||void 0===d?void 0:d.map((e=>(0,i.jsxs)("div",{className:l.row,onClick:()=>g(e.id,e),children:[(0,i.jsx)("input",{type:"radio",checked:m===e.id}),e[v]]},e.id)))})})}):(0,i.jsx)("tbody",{children:(0,i.jsx)("tr",{children:(0,i.jsx)("td",{children:null===u||void 0===u?void 0:u.map((e=>(0,i.jsxs)("div",{className:l.row,onClick:()=>g(e.id,e),children:[(0,i.jsx)("input",{type:"radio",checked:m===e.id}),e[v]]},e.id)))})})})]})]})})}},8448:(e,t,a)=>{a.r(t),a.d(t,{default:()=>z});var l=a(9379),r=a(5043);const n={dialog:"ControlPanel_dialog__-PRLx",main:"ControlPanel_main__VeEeW",droppableContainer:"ControlPanel_droppableContainer__9GSun",graphics:"ControlPanel_graphics__jR+pi",handler:"ControlPanel_handler__Nzq9E"};var o=a(7422),i=a(1268),s=a(9742),c=a(8877),d=a(7321),u=a(6378),v=a(6537),m=a(71);const g={modal:"ModalStatistic_modal__xnYMU",modalWindow:"ModalStatistic_modalWindow__zFlcx",exit:"ModalStatistic_exit__3Kwga",item_rowSVG:"ModalStatistic_item_rowSVG__zWOHp",item_rowBtns:"ModalStatistic_item_rowBtns__fF9s5",btn:"ModalStatistic_btn__pE0UU",btn_active:"ModalStatistic_btn_active__Kqc-6",blockArrrow:"ModalStatistic_blockArrrow__v9Ki-",row_svg_arrow:"ModalStatistic_row_svg_arrow__F6xR0"};var p=a(9103),D=a(8053),h=a(7583),x=a(543),w=a(3066),f=a(579);const S=e=>{let{data:t,graphicTypeBD:a,type:n,name:o,exit:i,reportDay:s}=e;const c=(0,r.useRef)(),[d,u]=(0,r.useState)(850),[v,m]=(0,r.useState)(640),[S,_]=(0,r.useState)([]),[y,N]=(0,r.useState)(a),[C,M]=(0,r.useState)(0);(0,r.useEffect)((()=>{const e=()=>{window.innerHeight>900?m(640):window.innerHeight>500&&m(420)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>{if(M(0),"\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0439"===y){var e;const a=new Date,r=a.getDay(),n=new Date(a);let o;o=r>=s?r-s:7-(s-r),n.setDate(a.getDate()-o);const i=new Date(n);i.setDate(n.getDate()+7);const c=[];for(let e=new Date(n);e<i;e.setDate(e.getDate()+1))c.push(new Date(e).toISOString().split("T")[0]);const d=null===t||void 0===t||null===(e=t.filter((e=>{const t=null!==e&&void 0!==e&&e.valueDate?new Date(e.valueDate):null;if(isNaN(null===t||void 0===t?void 0:t.getTime()))return!1;const a=n instanceof Date&&!isNaN(n.getTime()),l=i instanceof Date&&!isNaN(i.getTime());if(!a||!l)return!1;const r=t.toISOString().split("T")[0],o=n.toISOString().split("T")[0],s=i.toISOString().split("T")[0];return o<=r&&r<s&&!0!==e.isCorrelation})))||void 0===e?void 0:e.map((e=>{var t;return(0,l.A)((0,l.A)({},e),{},{valueDate:null===(t=e.valueDate)||void 0===t?void 0:t.split("T")[0]})})),u=[],v=[];c.forEach((e=>{const t=d.find((t=>t.valueDate===e));t?u.push(t):v.push({id:e,valueDate:e,value:"",isCorrelation:!1})})),u.sort(((e,t)=>new Date(t.valueDate)-new Date(e.valueDate))),v.sort(((e,t)=>new Date(t.valueDate)-new Date(e.valueDate))),_([...u,...v])}if("\u0415\u0436\u0435\u043c\u0435\u0441\u044f\u0447\u043d\u044b\u0439"===y){const e=t.reduce(((e,t)=>{const a=new Date(t.valueDate),l="".concat(a.getFullYear(),"-").concat(a.getMonth()+1);var r;!isNaN(a)&&new Date((new Date).setMonth((new Date).getMonth()-13))<a&&(!0===(null===t||void 0===t?void 0:t.isCorrelation)&&(e[l]={id:t.id,valueSum:t.value,year:a.getFullYear(),month:a.getMonth()+1,isCorrelation:!0}),e[l]&&null!==(r=e[l])&&void 0!==r&&r.isCorrelation||(e[l]||(e[l]={valueSum:0,year:a.getFullYear(),month:a.getMonth()+1,isCorrelation:!1}),e[l].valueSum+=t.value));return e}),{}),l=[];for(let t=0;t<13;t++){var a;const r=new Date;r.setMonth(r.getMonth()-t);const n="".concat(r.getFullYear(),"-").concat(r.getMonth()+1);e[n]||(e[n]={valueSum:0,year:r.getFullYear(),month:r.getMonth()+1,isCorrelation:!1});const o=new Date(r.getFullYear(),r.getMonth()+1,0),i=o.getFullYear(),s=o.getMonth()+1,c=o.getDate();l.push({id:(null===(a=e[n])||void 0===a?void 0:a.id)||null,valueDate:"".concat(i,"-").concat(s,"-").concat(c),value:e[n].valueSum,isCorrelation:e[n].isCorrelation})}l.sort(((e,t)=>new Date(t.valueDate)-new Date(e.valueDate))),_(l)}if("\u0415\u0436\u0435\u0433\u043e\u0434\u043e\u0432\u043e\u0439"===y){const e=t.reduce(((e,t)=>{const a=new Date(t.valueDate),l="".concat(a.getFullYear());var r;!isNaN(a)&&(new Date).getFullYear()-12<a.getFullYear()&&(!0===(null===t||void 0===t?void 0:t.isCorrelation)&&(e[l]={id:t.id,valueSum:t.value,year:a.getFullYear(),isCorrelation:!0}),e[l]&&null!==(r=e[l])&&void 0!==r&&r.isCorrelation||(e[l]||(e[l]={valueSum:0,year:a.getFullYear(),isCorrelation:!1}),e[l].valueSum+=t.value));return e}),{}),a=[];for(let t=0;t<12;t++){var r;const l=new Date;l.setFullYear(l.getFullYear()-t);const n="".concat(l.getFullYear());e[n]||(e[n]={valueSum:0,year:l.getFullYear(),isCorrelation:!1}),a.push({id:(null===(r=e[n])||void 0===r?void 0:r.id)||null,valueDate:"".concat(l.getFullYear(),"-01-01"),value:e[n].valueSum,isCorrelation:e[n].isCorrelation})}a.sort(((e,t)=>new Date(t.valueDate)-new Date(e.valueDate))),_(a)}if("13"===y||"26"===y||"52"===y){const e=new Date,a=new Date(e),l=new Date;l.setDate(e.getDate()-7*(Number(y)+1));const r=parseInt(s);if(isNaN(r))throw new Error("selectedDayOfWeek \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0447\u0438\u0441\u043b\u043e\u043c.");const n=[];let o=new Date(l);for(;o.getDay()!==r;)console.log("11111111111111"),o.setDate(o.getDate()+1);for(;o<=a;){console.log("2222222222222222");const a=new Date(o);a.setDate(o.getDate()+7);const l=t.filter((e=>{const t=new Date(e.valueDate);return o<=t&&t<a&&!0!==e.isCorrelation})).reduce(((e,t)=>e+t.value),0),r=new Date(a.getTime()+864e5);r<=e&&n.push({value:l,valueDate:r.toISOString().split("T")[0]}),o=a}_(n.sort(((e,t)=>new Date(t.valueDate)-new Date(e.valueDate))))}}),[y]),(0,r.useEffect)((()=>{S.sort(((e,t)=>new Date(e.valueDate)-new Date(t.valueDate)));const e=40,t=20,a=80,l=50,r=(p.jkA(S,(e=>e.value)),1.1*p.T9B(S,(e=>e.value))),o=p.hqK().domain(S.map((e=>""===e.valueDate||null===e.valueDate?"\u0434\u0430\u0442\u0430":(0,D.A)(e.valueDate,y)))).range([l,d-t]).padding(0),i="\u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f"===n?p.m4Y().domain([0,r]).nice().range([e,v-a]):p.m4Y().domain([0,r]).nice().range([v-a,e]),s=p.n8j().x((e=>o(""===e.valueDate||null===e.valueDate?"\u0434\u0430\u0442\u0430":(0,D.A)(e.valueDate,y)))).y((e=>i(e.value))).defined((e=>null!==e.value));p.Ltv(c.current).selectAll("*").remove();const u=p.Ltv(c.current).attr("width",d).attr("height",v),m=S.map((e=>""===e.valueDate||null===e.valueDate?"\u0434\u0430\u0442\u0430":(0,D.A)(e.valueDate,y))),g=i.ticks(5);u.selectAll(".grid-vertical").data(m).enter().append("line").attr("class","grid-vertical").attr("x1",(e=>o(e))).attr("x2",(e=>o(e))).attr("y1",e).attr("y2",v-a).attr("stroke","#4a4a4a").attr("stroke-width",1).attr("opacity",.3),u.selectAll(".grid-horizontal").data(g).enter().append("line").attr("class","grid-horizontal").attr("x1",l).attr("x2",d-t).attr("y1",(e=>i(e))).attr("y2",(e=>i(e))).attr("stroke","#4a4a4a").attr("stroke-width",1).attr("opacity",.3);const h=p.l78(o);u.append("g").attr("transform","translate(0,".concat(v-a,")")).call(h).selectAll("text").attr("transform","rotate(-90)").attr("text-anchor","end").attr("dx","-10px").attr("dy","-5px").style("font-weight","bold").style("font-size","12px"),u.append("g").attr("transform","translate(".concat(l,",0)")).call(p.V4s(i).ticks(5).tickFormat(p.GPZ(".2s"))),S.forEach(((e,t)=>{if(t>0){const a=S[t-1].value,l="\u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f"===n?e.value<a?"blue":"red":e.value<a?"red":"blue";u.append("path").datum([S[t-1],e]).attr("fill","none").attr("stroke",l).attr("stroke-width",2).attr("d",s)}}));const x=(e,t)=>{if(t>0){const a=S[t-1].value;return"\u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f"===n?e<a?"blue":"red":e<a?"red":"blue"}return"green"};u.selectAll("circle").data(S).enter().append("circle").attr("cx",(e=>o(""===e.valueDate||null===e.valueDate?"\u0434\u0430\u0442\u0430":(0,D.A)(e.valueDate,y)))).attr("cy",(e=>i(e.value))).attr("r",5).attr("fill",((e,t)=>x(e.value,t))).on("mouseover",((a,r)=>{p.Ltv(a.currentTarget).attr("r",7).attr("fill","orange");const n=o(""===r.valueDate||null===r.valueDate?"\u0434\u0430\u0442\u0430":(0,D.A)(r.valueDate,y)),s=i(r.value)-15,c="\u0414\u0430\u0442\u0430: ".concat(""===r.valueDate||null===r.valueDate?"\u0434\u0430\u0442\u0430":(0,D.A)(r.valueDate,y)),v="\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435: ".concat(r.value),m=6*Math.max(c.length,v.length),g=Math.max(120,m+20),h=s-50<e;let w=n;n+g/2>d-t?w=d-t-g/2:n-g/2<l&&(w=l+g/2);const f=h?s+50:s,_=x(r.value,S.indexOf(r)),N=u.append("g").attr("id","tooltip").attr("transform","translate(".concat(w,", ").concat(f,")"));N.append("rect").attr("x",-g/2).attr("y",h?0:-50).attr("width",g).attr("height",50).attr("fill",_).attr("rx",4).attr("ry",4),N.append("text").attr("text-anchor","middle").attr("y",h?15:-30).style("font-size","11px").style("fill","white").style("font-family","Montserrat, sans-serif").text(c),N.append("text").attr("text-anchor","middle").attr("y",h?35:-10).style("font-size","11px").style("fill","white").style("font-family","Montserrat, sans-serif").text(v)})).on("mouseout",(e=>{const t=p.Ltv(e.currentTarget).datum(),a=S.indexOf(t);p.Ltv(e.currentTarget).attr("r",5).attr("fill",x(t.value,a)),u.select("#tooltip").remove()}))}),[S]);return(0,r.useEffect)((()=>{(()=>{if(_([]),t.length){if("\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0439"===y){const e=new Date,a=e.getDay(),r=new Date(e);let n;n=a>=s?a-s:7-(s-a),r.setDate(e.getDate()-n);const o=new Date(e);o.setDate(e.getDate()-7),r<o&&r.setTime(o.getTime());const i=[];for(let t=C;t<7+C;t++){const a=new Date(e);a.setDate(e.getDate()-t),i.push(a.toISOString().split("T")[0])}const c=t.reduce(((e,t)=>{const a=t.valueDate.split("T")[0];return e[a]=(0,l.A)((0,l.A)({},t),{},{valueDate:a}),e}),{}),d=i.map((e=>c[e]&&!0!==c[e].isCorrelation?c[e]:{id:e,valueDate:e,value:"",isCorrelation:!1})),u=d.filter((e=>""===e.value)),v=d.filter((e=>""!==e.value));_([...v,...u])}if("\u0415\u0436\u0435\u043c\u0435\u0441\u044f\u0447\u043d\u044b\u0439"===y){const a=t.reduce(((e,t)=>{const a=new Date(t.valueDate),l="".concat(a.getFullYear(),"-").concat(a.getMonth()+1);var r;return!isNaN(a)&&new Date((new Date).setMonth((new Date).getMonth()-14+C))<a&&(!0===(null===t||void 0===t?void 0:t.isCorrelation)&&(e[l]={id:t.id,valueSum:t.value,year:a.getFullYear(),month:a.getMonth()+1,isCorrelation:!0}),e[l]&&null!==(r=e[l])&&void 0!==r&&r.isCorrelation||(e[l]||(e[l]={valueSum:0,year:a.getFullYear(),month:a.getMonth()+1,isCorrelation:!1}),e[l].valueSum+=t.value)),e}),{}),l=[];for(let t=C;t<13+C;t++){var e;const r=new Date;r.setMonth(r.getMonth()-t);const n="".concat(r.getFullYear(),"-").concat(r.getMonth()+1);a[n]||(a[n]={valueSum:0,year:r.getFullYear(),month:r.getMonth()+1,isCorrelation:!1});const o=new Date(r.getFullYear(),r.getMonth()+1,0),i=o.getFullYear(),s=o.getMonth()+1,c=o.getDate();l.push({id:(null===(e=a[n])||void 0===e?void 0:e.id)||null,valueDate:"".concat(i,"-").concat(s,"-").concat(c),value:a[n].valueSum,isCorrelation:a[n].isCorrelation})}l.sort(((e,t)=>new Date(t.valueDate)-new Date(e.valueDate))),_(l)}if("\u0415\u0436\u0435\u0433\u043e\u0434\u043e\u0432\u043e\u0439"===y){const e=t.reduce(((e,t)=>{const a=new Date(t.valueDate),l="".concat(a.getFullYear());var r;return!isNaN(a)&&(new Date).getFullYear()-12<a.getFullYear()&&(!0===(null===t||void 0===t?void 0:t.isCorrelation)&&(e[l]={id:t.id,valueSum:t.value,year:a.getFullYear(),isCorrelation:!0}),e[l]&&null!==(r=e[l])&&void 0!==r&&r.isCorrelation||(e[l]||(e[l]={valueSum:0,year:a.getFullYear(),isCorrelation:!1}),e[l].valueSum+=t.value)),e}),{}),l=[];for(let t=C;t<12+C;t++){var a;const r=new Date;r.setFullYear(r.getFullYear()-t);const n="".concat(r.getFullYear());e[n]||(e[n]={valueSum:0,year:r.getFullYear(),isCorrelation:!1}),l.push({id:(null===(a=e[n])||void 0===a?void 0:a.id)||null,valueDate:"".concat(r.getFullYear(),"-01-01"),value:e[n].valueSum,isCorrelation:e[n].isCorrelation})}l.sort(((e,t)=>new Date(t.valueDate)-new Date(e.valueDate))),_(l)}if("13"===y||"26"===y||"52"===y){const e=new Date;e.setDate(e.getDate()-7*C);const a=new Date(e),l=new Date(a);l.setDate(a.getDate()-7*(Number(y)+1));const r=parseInt(s),n=[];let o=new Date(l),i=0;for(;o.getDay()!==r;)o.setDate(o.getDate()+1);for(;o<=a;){const a=new Date(o);a.setDate(o.getDate()+7),i=t.filter((e=>{const t=new Date(e.valueDate);return o<=t&&t<a&&!0!==e.isCorrelation})).reduce(((e,t)=>e+t.value),0);const l=new Date(a.getTime()+864e5);l<=e&&n.push({value:i,valueDate:l.toISOString().split("T")[0]}),o=a}_(n.sort(((e,t)=>new Date(t.valueDate)-new Date(e.valueDate))))}}})()}),[C]),(0,f.jsx)("div",{className:g.modal,children:(0,f.jsxs)("div",{className:g.modalWindow,children:[(0,f.jsx)("img",{src:h.A,alt:"exitModal",onClick:()=>i(),className:g.exit}),(0,f.jsxs)("div",{className:g.item_rowSVG,children:[(0,f.jsx)("span",{children:o}),(0,f.jsxs)("div",{className:g.row_svg_arrow,children:[(0,f.jsx)("svg",{ref:c}),(0,f.jsxs)("div",{className:g.blockArrrow,children:[(0,f.jsx)("div",{className:g.statisticsArrow,children:(0,f.jsx)("img",{src:x.A,alt:"arrowLeft",onClick:()=>{M((e=>e+1))}})}),(0,f.jsx)("div",{className:g.statisticsArrow,children:(0,f.jsx)("img",{src:w.A,alt:"arrowRight",onClick:()=>{M((e=>e-1))}})})]})]})]}),(0,f.jsx)("div",{className:g.item_rowBtns,children:[{type:"13",value:"13 \u043d\u0435\u0434\u0435\u043b\u044c"},{type:"26",value:"26 \u043d\u0435\u0434\u0435\u043b\u044c"},{type:"52",value:"52 \u043d\u0435\u0434\u0435\u043b\u0438"},{type:"\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0439",value:"\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0439"},{type:"\u0415\u0436\u0435\u043c\u0435\u0441\u044f\u0447\u043d\u044b\u0439",value:"\u0415\u0436\u0435\u043c\u0435\u0441\u044f\u0447\u043d\u044b\u0439"},{type:"\u0415\u0436\u0435\u0433\u043e\u0434\u043e\u0432\u043e\u0439",value:"\u0415\u0436\u0435\u0433\u043e\u0434\u043e\u0432\u043e\u0439"}].map((e=>(0,f.jsx)("button",{className:"".concat(g.btn," ").concat(y===e.type?g.btn_active:""),onClick:()=>(e=>{N(e)})(e.type),children:e.value},n)))})]})})},_={block:"PanelDragDrop_block__cXsLG",name:"PanelDragDrop_name__a5nrj",button:"PanelDragDrop_button__sN3aR",active:"PanelDragDrop_active__0Obwj"};var y=a(9792);function N(e){let{name:t,openSetting:a,onClick:l,deletePanel:r,isActive:n}=e;return(0,f.jsxs)("div",{"data-tour":"controlPanel",className:"".concat(_.block," ").concat(n?_.active:""),onClick:l,children:[(0,f.jsx)("div",{className:_.name,children:(0,f.jsx)("span",{children:t})}),(0,f.jsxs)("div",{className:_.button,children:[(0,f.jsx)("img",{"data-tour":"setting-controlPanel",src:y.A,alt:"setting",onClick:a}),(0,f.jsx)("img",{"data-tour":"delete-controlPanel",src:h.A,alt:"exitModal",onClick:r})]})]})}const C={modal:"ModalSetting_modal__EUtYN",modalWindow:"ModalSetting_modalWindow__FLkN4",exit:"ModalSetting_exit__ajeLI",wrapper:"ModalSetting_wrapper__bieWa",header:"ModalSetting_header__qghfj",save:"ModalSetting_save__6u4Da",blockSelect:"ModalSetting_blockSelect__F9Lou"};var M=a(4530),j=a(917),A=a(2941),b=a(9307),P=a(533);function Y(e){let{exit:t,currentControlPanel:a,updateControlPanel:n,statisticsIdsInPanel:o}=e;const[i,s]=(0,r.useState)(""),[d,u]=(0,r.useState)(""),[v,m]=(0,r.useState)(""),[g,p]=(0,r.useState)(""),[D,x]=(0,r.useState)([]),{statistics:w,isLoadingGetStatistics:S,isFetchingGetStatistics:_,isErrorGetStatistics:y}=(0,c.SE)({statisticData:!1});return(0,r.useEffect)((()=>{a&&(u(a.isNameChanged?a.panelName:"".concat(a.panelName," ").concat(a.controlPanelNumber)),s(a.isNameChanged?a.panelName:"".concat(a.panelName," ").concat(a.controlPanelNumber)),m(a.panelType),p(a.graphType)),o&&x(o)}),[a,o]),(0,f.jsx)("div",{className:C.modal,children:(0,f.jsxs)("div",{className:C.modalWindow,children:[(0,f.jsx)("img",{src:h.A,alt:"exitModal",onClick:t,className:C.exit}),(0,f.jsxs)("div",{className:C.wrapper,children:[(0,f.jsxs)("div",{className:C.header,children:[(0,f.jsx)("div",{className:C.save,children:(0,f.jsx)(b.A,{name:"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",icon:M.A,onClick:async()=>{const e={};e.statisticIds=D,i!==d&&(e.panelName=d),a.panelType!==v&&(e.panelType=v),a.graphType!==g&&(e.graphType=g),await n((0,l.A)((0,l.A)({},e),{},{id:a.id})).unwrap().then((()=>{t()})).catch((e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430:",JSON.stringify(e,null,2))}))}})}),(0,f.jsx)(j.A,{name:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0430\u043d\u0435\u043b\u0438",value:"".concat(d),onChange:u}),(0,f.jsxs)("div",{className:C.blockSelect,children:[(0,f.jsx)(A.A,{name:"\u0422\u0438\u043f \u043f\u0430\u043d\u0435\u043b\u0438",value:v,onChange:m,array:[{id:"\u041b\u0438\u0447\u043d\u0430\u044f",type:"\u041b\u0438\u0447\u043d\u0430\u044f"},{id:"\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u0430\u044f",type:"\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u0430\u044f"}],arrayItem:"type"}),(0,f.jsx)(A.A,{name:"\u0422\u0438\u043f \u0433\u0440\u0430\u0444\u0438\u043a\u043e\u0432",value:g,onChange:p,array:[{id:"\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0439",value:"\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0439",view:"\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0439"},{id:"\u0415\u0436\u0435\u043c\u0435\u0441\u044f\u0447\u043d\u044b\u0439",value:"\u0415\u0436\u0435\u043c\u0435\u0441\u044f\u0447\u043d\u044b\u0439",view:"\u0415\u0436\u0435\u043c\u0435\u0441\u044f\u0447\u043d\u044b\u0439"},{id:"\u0415\u0436\u0435\u0433\u043e\u0434\u043e\u0432\u043e\u0439",value:"\u0415\u0436\u0435\u0433\u043e\u0434\u043e\u0432\u043e\u0439",view:"\u0415\u0436\u0435\u0433\u043e\u0434\u043e\u0432\u043e\u0439"},{id:"13",value:"13",view:"13 \u043d\u0435\u0434\u0435\u043b\u044c"},{id:"26",value:"26",view:"26 \u043d\u0435\u0434\u0435\u043b\u044c"},{id:"52",value:"52",view:"52 \u043d\u0435\u0434\u0435\u043b\u0438"}],arrayItem:"view"})]})]}),(0,f.jsx)(P.A,{nameTable:"\u041f\u0440\u0438\u043a\u0440\u0435\u043f\u043b\u0435\u043d\u043d\u044b\u0435 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438",array:w,arrayItem:"name",arrayCheked:D,handleChecboxChange:e=>{x((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))}})]})]})})}var F=a(1648),k=a(1024);const I={graphic:"CardStatistic_graphic__Yss59"};function T(e){let{name:t,data:a,typeGraphic:n,type:o,reportDay:i,setOpenModalStatistic:s,setModalStatisticName:c,setModalStatisticDatas:d}=e;const u=(0,r.useRef)(),[v,m]=(0,r.useState)(300),[g,h]=(0,r.useState)(340),[x,w]=(0,r.useState)([]),[S,_]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{if("\u0415\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u044b\u0439"===n){const e=new Date,t=e.getDay(),r=new Date(e);let n;n=t>=i?t-i:7-(i-t),r.setDate(e.getDate()-n);const o=new Date(e);o.setDate(e.getDate()-7),r<o&&r.setTime(o.getTime());const s=[];for(let a=0;a<7;a++){const t=new Date(e);t.setDate(e.getDate()-a),s.push(t.toISOString().split("T")[0])}const c=a.reduce(((e,t)=>{const a=t.valueDate.split("T")[0];return e[a]=(0,l.A)((0,l.A)({},t),{},{valueDate:a}),e}),{}),d=s.map((e=>c[e]&&!0!==c[e].isCorrelation?c[e]:{id:e,valueDate:e,value:"",isCorrelation:!1})),u=d.filter((e=>""===e.value)),v=d.filter((e=>""!==e.value));w([...v,...u])}if("\u0415\u0436\u0435\u043c\u0435\u0441\u044f\u0447\u043d\u044b\u0439"===n){const t=a.reduce(((e,t)=>{const a=new Date(t.valueDate),l="".concat(a.getFullYear(),"-").concat(a.getMonth()+1);var r;!isNaN(a)&&new Date((new Date).setMonth((new Date).getMonth()-13))<a&&(!0===(null===t||void 0===t?void 0:t.isCorrelation)&&(e[l]={id:t.id,valueSum:t.value,year:a.getFullYear(),month:a.getMonth()+1,isCorrelation:!0}),e[l]&&null!==(r=e[l])&&void 0!==r&&r.isCorrelation||(e[l]||(e[l]={valueSum:0,year:a.getFullYear(),month:a.getMonth()+1,isCorrelation:!1}),e[l].valueSum+=t.value));return e}),{}),l=[];for(let a=0;a<13;a++){var e;const r=new Date;r.setMonth(r.getMonth()-a);const n="".concat(r.getFullYear(),"-").concat(r.getMonth()+1);t[n]||(t[n]={valueSum:0,year:r.getFullYear(),month:r.getMonth()+1,isCorrelation:!1});const o=new Date(r.getFullYear(),r.getMonth()+1,0),i=o.getFullYear(),s=o.getMonth()+1,c=o.getDate();l.push({id:(null===(e=t[n])||void 0===e?void 0:e.id)||null,valueDate:"".concat(i,"-").concat(s,"-").concat(c),value:t[n].valueSum,isCorrelation:t[n].isCorrelation})}l.sort(((e,t)=>new Date(t.valueDate)-new Date(e.valueDate))),w(l)}if("\u0415\u0436\u0435\u0433\u043e\u0434\u043e\u0432\u043e\u0439"===n){const e=a.reduce(((e,t)=>{const a=new Date(t.valueDate),l="".concat(a.getFullYear());var r;!isNaN(a)&&(new Date).getFullYear()-12<a.getFullYear()&&(!0===(null===t||void 0===t?void 0:t.isCorrelation)&&(e[l]={id:t.id,valueSum:t.value,year:a.getFullYear(),isCorrelation:!0}),e[l]&&null!==(r=e[l])&&void 0!==r&&r.isCorrelation||(e[l]||(e[l]={valueSum:0,year:a.getFullYear(),isCorrelation:!1}),e[l].valueSum+=t.value));return e}),{}),l=[];for(let a=0;a<12;a++){var t;const r=new Date;r.setFullYear(r.getFullYear()-a);const n="".concat(r.getFullYear());e[n]||(e[n]={valueSum:0,year:r.getFullYear(),isCorrelation:!1}),l.push({id:(null===(t=e[n])||void 0===t?void 0:t.id)||null,valueDate:"".concat(r.getFullYear(),"-01-01"),value:e[n].valueSum,isCorrelation:e[n].isCorrelation})}l.sort(((e,t)=>new Date(t.valueDate)-new Date(e.valueDate))),w(l)}if("13"===n||"26"===n||"52"===n){const e=new Date,t=new Date(e),l=new Date;l.setDate(e.getDate()-7*(Number(n)+1));const r=parseInt(i);if(isNaN(r))throw new Error("selectedDayOfWeek \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0447\u0438\u0441\u043b\u043e\u043c.");const o=[];let s=new Date(l);for(;s.getDay()!==r;)s.setDate(s.getDate()+1);for(;s<=t;){const t=new Date(s);t.setDate(s.getDate()+7);const l=a.filter((e=>{const a=new Date(e.valueDate);return s<=a&&a<t&&!0!==e.isCorrelation})).reduce(((e,t)=>e+t.value),0),r=new Date(t.getTime()+864e5);r<=e&&o.push({value:l,valueDate:r.toISOString().split("T")[0]}),s=t}w(o.sort(((e,t)=>new Date(t.valueDate)-new Date(e.valueDate))))}}),[a,n]),(0,r.useEffect)((()=>{null===x||void 0===x||x.sort(((e,t)=>new Date(e.valueDate)-new Date(t.valueDate)));const e=20,t=20,a=40,l=20,r=(p.jkA(x,(e=>e.value)),1.1*p.T9B(x,(e=>e.value))),i=p.hqK().domain(x.map((e=>""===e.valueDate||null===e.valueDate?"\u0434\u0430\u0442\u0430":(0,D.A)(e.valueDate,n)))).range([l,v-t]).padding(0),s="\u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f"===o?p.m4Y().domain([0,r]).nice().range([e,g-a]):p.m4Y().domain([0,r]).nice().range([g-a,e]),c=p.n8j().x((e=>i(""===e.valueDate||null===e.valueDate?"\u0434\u0430\u0442\u0430":(0,D.A)(e.valueDate,n)))).y((e=>s(e.value))).defined((e=>null!==e.value));p.Ltv(u.current).selectAll("*").remove();const d=p.Ltv(u.current).attr("width",v).attr("height",g),m=x.map((e=>""===e.valueDate||null===e.valueDate?"\u0434\u0430\u0442\u0430":(0,D.A)(e.valueDate,n))),h=s.ticks(5);d.selectAll(".grid-vertical").data(m).enter().append("line").attr("class","grid-vertical").attr("x1",(e=>i(e))).attr("x2",(e=>i(e))).attr("y1",e).attr("y2",g-a).attr("stroke","#4a4a4a").attr("stroke-width",1).attr("opacity",.3),d.selectAll(".grid-horizontal").data(h).enter().append("line").attr("class","grid-horizontal").attr("x1",l).attr("x2",v-t).attr("y1",(e=>s(e))).attr("y2",(e=>s(e))).attr("stroke","#4a4a4a").attr("stroke-width",1).attr("opacity",.3);const w=p.l78(i).tickFormat((()=>"")).tickSize(0);d.append("g").attr("transform","translate(0,".concat(g-a,")")).call(w).selectAll("text").attr("transform","rotate(-90)").attr("text-anchor","end").attr("dx","-10px").attr("dy","-5px").style("font-weight","bold").style("font-size","12px");const f=p.V4s(s).tickFormat((()=>"")).tickSize(0);d.append("g").attr("transform","translate(".concat(l,",0)")).call(f),x.forEach(((e,t)=>{if(t>0){const a=x[t-1].value,l="\u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f"===o?e.value<a?"blue":"red":e.value<a?"red":"blue";d.append("path").datum([x[t-1],e]).attr("fill","none").attr("stroke",l).attr("stroke-width",2).attr("d",c)}}));const S=(e,t)=>{if(t>0){const a=x[t-1].value;return"\u041e\u0431\u0440\u0430\u0442\u043d\u0430\u044f"===o?e<a?"blue":"red":e<a?"red":"blue"}return"blue"};d.selectAll("circle").data(x).enter().append("circle").attr("cx",(e=>i(""===e.valueDate||null===e.valueDate?"\u0434\u0430\u0442\u0430":(0,D.A)(e.valueDate,n)))).attr("cy",(e=>s(e.value))).attr("r",5).attr("fill",((e,t)=>S(e.value,t))).on("mouseover",((a,r)=>{p.Ltv(a.currentTarget).attr("r",7).attr("fill","orange");const o=i(""===r.valueDate||null===r.valueDate?"\u0434\u0430\u0442\u0430":(0,D.A)(r.valueDate,n)),c=s(r.value)-15,u="\u0414\u0430\u0442\u0430: ".concat(""===r.valueDate||null===r.valueDate?"\u0434\u0430\u0442\u0430":(0,D.A)(r.valueDate,n)),m="\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435: ".concat(r.value),g=6*Math.max(u.length,m.length),h=Math.max(120,g+20),w=c-50<e;let f=o;o+h/2>v-t?f=v-t-h/2:o-h/2<l&&(f=l+h/2);const _=w?c+50:c,y=S(r.value,x.indexOf(r)),N=d.append("g").attr("id","tooltip").attr("transform","translate(".concat(f,", ").concat(_,")"));N.append("rect").attr("x",-h/2).attr("y",w?0:-50).attr("width",h).attr("height",50).attr("fill",y).attr("rx",4).attr("ry",4),N.append("text").attr("text-anchor","middle").attr("y",w?15:-30).style("font-size","11px").style("fill","white").style("font-family","Montserrat, sans-serif").text(u),N.append("text").attr("text-anchor","middle").attr("y",w?35:-10).style("font-size","11px").style("fill","white").style("font-family","Montserrat, sans-serif").text(m)})).on("mouseout",(e=>{const t=p.Ltv(e.currentTarget).datum(),a=x.indexOf(t);p.Ltv(e.currentTarget).attr("r",5).attr("fill",S(t.value,a)),d.select("#tooltip").remove()}))}),[x]),(0,f.jsxs)("div",{"data-tour":"cardStatistics",className:I.graphic,onPointerDown:e=>{_(!1)},onPointerMove:()=>{_(!0)},onPointerUp:()=>{S||(s(!0),c(t),d(a))},children:[(0,f.jsx)("span",{children:t}),(0,f.jsx)("svg",{ref:u})]})}function E(e){let{id:t,item:a,type:r,typeGraphic:n,reportDay:o,setOpenModalStatistic:i,setModalStatisticName:s,setModalStatisticDatas:c}=e;const{attributes:d,listeners:u,setNodeRef:v,transform:m,transition:g}=(0,F.gl)({id:t}),p={transform:k.Ks.Transform.toString(m),transition:g};return(0,f.jsx)("div",(0,l.A)((0,l.A)((0,l.A)({ref:v,style:p},d),u),{},{children:(0,f.jsx)(T,{name:a.name,data:[...a.statisticDatas],type:r,typeGraphic:n,reportDay:o,setOpenModalStatistic:i,setModalStatisticName:s,setModalStatisticDatas:c})}))}var O=a(3585),R=a(6933),L=a(1921),W=a(3536),G=a(839),B=a(4863),U=a(4293);function z(){var e,t,a,g,p,D,h,x,w,_,y,C,M,j,A;const[b,P]=(0,r.useState)(!1),[k,I]=(0,r.useState)(!1),[T,z]=(0,r.useState)(!1),[q,H]=(0,r.useState)(),[K,V]=(0,r.useState)([]),[J,Z]=(0,r.useState)([]),[Q,X]=(0,r.useState)(!1),[$,ee]=(0,r.useState)(""),[te,ae]=(0,r.useState)([]),le=(0,r.useRef)(null),[re,ne]=(0,r.useState)(!1),oe=[{title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",description:"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043f\u0430\u043d\u0435\u043b\u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f",target:()=>le.current},{title:"\u041f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f",description:"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0434\u043b\u044f \u043f\u043e\u043a\u0430\u0437\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u043c\u043e\u0433\u043e (\u0437\u0430\u0436\u043c\u0438\u0442\u0435 \u0438 \u043f\u043e\u043c\u0435\u043d\u044f\u0439\u0442\u0435 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u043f\u0430\u043d\u0435\u043b\u0435\u0439 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0439)",target:()=>document.querySelector('[data-tour="controlPanel"]'),disabled:!document.querySelector('[data-tour="controlPanel"]')},{title:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",description:"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0438 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u043f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f",target:()=>document.querySelector('[data-tour="setting-controlPanel"]'),disabled:!document.querySelector('[data-tour="setting-controlPanel"]')},{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",description:"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442\u0435 \u043f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f",target:()=>document.querySelector('[data-tour="delete-controlPanel"]'),disabled:!document.querySelector('[data-tour="delete-controlPanel"]')},{title:"\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0430 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438",description:"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0434\u043b\u044f \u043f\u043e\u043a\u0430\u0437\u0430 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0439 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0438 (\u0437\u0430\u0436\u043c\u0438\u0442\u0435 \u0438 \u043f\u043e\u043c\u0435\u043d\u044f\u0439\u0442\u0435 \u043f\u043e\u0440\u044f\u0434\u043e\u043a \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a)",target:()=>document.querySelector('[data-tour="cardStatistics"]'),disabled:!document.querySelector('[data-tour="cardStatistics"]')}].filter((e=>!e.target.toString().includes("querySelector")||!e.disabled)),{reduxSelectedOrganizationId:ie,reduxSelectedOrganizationReportDay:se,allControlPanel:ce,isLoadingGetAllControlPanel:de,isFetchingGetAllControlPanel:ue,isErrorGetAllControlPanel:ve,currentControlPanel:me,statisticsIdsInPanel:ge,statisticsPoints:pe,isLoadingGetontrolPanelId:De,isFetchingGetontrolPanelId:he,isErrorGetontrolPanelId:xe,postControlPanel:we,isLoadingPostControlPanelMutation:fe,isSuccessPostControlPanelMutation:Se,isErrorPostControlPanelMutation:_e,ErrorPostControlPanel:ye,localIsResponsePostControlPanelMutation:Ne,updateControlPanel:Ce,isLoadingUpdateControlPanelMutation:Me,isSuccessUpdateControlPanelMutation:je,isErrorUpdateControlPanelMutation:Ae,ErrorUpdateControlPanel:be,localIsResponseUpdateControlPanelMutation:Pe,deleteControlPanel:Ye,isLoadingDeleteControlPanelMutation:Fe,isSuccessDeleteControlPanelMutation:ke,isErrorDeleteControlPanelMutation:Ie,ErrorDeleteControlPanel:Te,localIsResponseDeleteControlPanelMutation:Ee}=(0,c.DT)({selectedControlPanelId:q}),{allPosts:Oe,isLoadingGetPosts:Re,isErrorGetPosts:Le}=(0,c.es)(),{selectedID:We,selectedName:Ge,handleRadioChange:Be,handleInputChangeModalSearch:Ue,filterArraySearchModal:ze,inputSearchModal:qe}=(0,c.I7)({array:Oe,arrayItem:"postName"}),He=(0,O.FR)((0,O.MS)(O.AN),(0,O.MS)(O.uN,{coordinateGetter:F.JR})),{updatePanelToStatisticsUpdateOrderNumbers:Ke,isLoadingPanelToStatisticsUpdateOrderNumbersMutation:Ve,isSuccessPanelToStatisticsUpdateOrderNumbersMutation:Je,isErrorPanelToStatisticsUpdateOrderNumbersMutation:Ze,ErrorPanelToStatisticsUpdateOrderNumbersMutation:Qe,resetPanelToStatisticsUpdateOrderNumbersMutation:Xe,localIsResponsePanelToStatisticsUpdateOrderNumbersMutation:$e}=(0,L.A)(),et=(0,r.useCallback)((0,W.debounce)((e=>{Ke(e)}),5e3),[]);return(0,r.useEffect)((()=>{Object.keys(ce).length>0?(0,R.QN)(ie,(e=>{e.length>0?V((()=>ce.map((t=>{const a=e.find((e=>e.id===t.id));return a?(0,l.A)((0,l.A)({},t),{},{orderNumber:a.orderNumber,isActive:a.isActive}):t})).sort(((e,t)=>e.orderNumber-t.orderNumber)))):V(ce)})):V(ce)}),[ce]),(0,r.useEffect)((()=>{Z([])}),[ie]),(0,r.useEffect)((()=>{pe&&!(0,W.isEqual)(pe,J)&&Z(pe)}),[pe]),(0,f.jsxs)("div",{className:n.dialog,children:[(0,f.jsx)(o.A,{name:"\u043f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f",funcActiveHint:()=>ne(!0),children:(0,f.jsx)(i.A,{create:()=>{I(!0)},refCreate:le})}),(0,f.jsx)(G.Ay,{locale:U.A,children:(0,f.jsx)(B.A,{open:re,onClose:()=>ne(!1),steps:oe})}),(0,f.jsxs)("div",{className:n.main,children:[(0,f.jsx)(s.JY,{onDragEnd:async e=>{const{source:t,destination:a}=e;if(!a)return;const r=Array.from(K),[n]=r.splice(t.index,1);r.splice(a.index,0,n);const o=r.map(((e,t)=>(0,l.A)((0,l.A)({},e),{},{orderNumber:t+1})));V(o);try{await(0,R.cZ)(ie,o.map((e=>{let{id:t,orderNumber:a,panelName:l}=e;return{id:t,orderNumber:a,panelName:l}}))),console.log("\u0414\u0430\u043d\u043d\u044b\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b \u0432 IndexedDB")}catch(i){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 IndexedDB:",i)}},children:(0,f.jsx)(s.gL,{droppableId:"panelList",direction:"horizontal",children:e=>(0,f.jsxs)("div",(0,l.A)((0,l.A)({},e.droppableProps),{},{ref:e.innerRef,className:n.droppableContainer,children:[null===K||void 0===K?void 0:K.map(((e,t)=>(0,f.jsx)(s.sx,{draggableId:"item-".concat(t),index:t,children:t=>(0,f.jsx)("div",(0,l.A)((0,l.A)((0,l.A)({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{children:(0,f.jsx)(N,{isActive:me.id===e.id,openSetting:()=>P(!0),name:e.isNameChanged?e.panelName:"".concat(e.panelName," ").concat(e.controlPanelNumber),onClick:()=>{return t=e.id,(0,R.cZ)(ie,K.map((e=>{let{id:t,orderNumber:a,panelName:l}=e;return{id:t,orderNumber:a,panelName:l}})),t),console.log("getControlPanelId"),void H(t);var t},deletePanel:()=>z(!0)})}))},t))),e.placeholder]}))})}),J.length>0&&(0,f.jsx)(O.Mp,{sensors:He,collisionDetection:O.fp,onDragEnd:e=>{const{active:t,over:a}=e;t.id!==a.id&&Z((e=>{const l=e.findIndex((e=>e.id===t.id)),r=e.findIndex((e=>e.id===a.id)),n=(0,F.be)(e,l,r),o=n.map(((e,t)=>({_id:e.panelToStatisticsId,orderStatisticNumber:t+1})));return et(o),n}))},children:(0,f.jsx)(F.gB,{items:J,strategy:F.kL,children:(0,f.jsx)("div",{className:n.graphics,children:J.map((e=>(0,f.jsx)(E,{id:e.id,item:e,type:"\u041f\u0440\u044f\u043c\u0430\u044f",typeGraphic:me.graphType,reportDay:se,setOpenModalStatistic:X,setModalStatisticName:ee,setModalStatisticDatas:ae},e.id)))})})}),!xe&&!De&&!he&&b&&(0,f.jsx)(Y,{exit:()=>P(!1),updateControlPanel:Ce,currentControlPanel:me,statisticsIdsInPanel:ge}),!xe&&!De&&!he&&T&&(0,f.jsx)(u.A,{text:"\u0412\u044b \u0442\u043e\u0447\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f ".concat(me.isNameChanged?me.panelName:"".concat(me.panelName," ").concat(me.controlPanelNumber)),close:z,btnYes:()=>{(async()=>{try{await Ye({controlPanelId:q}).unwrap(),H(),z(!1),(0,R.Dl)(ie,q).then((()=>{console.log("\u041f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0441 id ".concat(q," \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0435\u043d\u0430 \u0438\u0437 IndexedDB."))})).catch((e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u0438\u0437 IndexedDB:",e)}))}catch(e){console.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043f\u0430\u043d\u0435\u043b\u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f:",JSON.stringify(e,null,2))}})()},btnNo:()=>{z(!1)}}),k&&(0,f.jsx)(d.$,{nameTable:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u0441\u0442\u0430",handleSearchValue:qe,handleSearchOnChange:Ue,handleRadioChange:Be,exit:()=>{I(!1)},filterArray:ze,array:Oe,arrayItem:"postName",selectedItemID:We,save:async()=>{await we({orderNumber:0==ce.length?1:ce.length+1,panelName:"".concat(Ge," \u2116"),organizationId:ie,postId:We}).unwrap().then((()=>{I(!1)})).catch((e=>{console.error("\u041e\u0448\u0438\u0431\u043a\u0430:",JSON.stringify(e,null,2))}))}}),Q&&(0,f.jsx)(S,{data:te,name:$,graphicTypeBD:me.graphType,type:"\u041f\u0440\u044f\u043c\u0430\u044f",exit:()=>X(!1),reportDay:se}),(0,f.jsxs)("div",{className:n.handler,children:[(0,f.jsx)(m.A,{Loading:de,Fetching:ue,Error:ve}),(0,f.jsx)(m.A,{Loading:De,Fetching:he,Error:xe}),(0,f.jsx)(v.A,{Loading:fe,Error:_e&&Ne,Success:Se&&Ne,textSuccess:"\u041f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u0430.",textError:null!==ye&&void 0!==ye&&null!==(e=ye.data)&&void 0!==e&&null!==(t=e.errors)&&void 0!==t&&null!==(a=t[0])&&void 0!==a&&null!==(g=a.errors)&&void 0!==g&&g[0]?ye.data.errors[0].errors[0]:null===ye||void 0===ye||null===(p=ye.data)||void 0===p?void 0:p.message}),(0,f.jsx)(v.A,{Loading:Me,Error:Ae&&Pe,Success:je&&Pe,textSuccess:"\u041f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430.",textError:null!==be&&void 0!==be&&null!==(D=be.data)&&void 0!==D&&null!==(h=D.errors)&&void 0!==h&&null!==(x=h[0])&&void 0!==x&&null!==(w=x.errors)&&void 0!==w&&w[0]?be.data.errors[0].errors[0]:null===be||void 0===be||null===(_=be.data)||void 0===_?void 0:_.message}),(0,f.jsx)(v.A,{Loading:Fe,Error:Ie&&Ee,Success:ke&&Ee,textSuccess:"\u041f\u0430\u043d\u0435\u043b\u044c \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0430",textError:null!==Te&&void 0!==Te&&null!==(y=Te.data)&&void 0!==y&&null!==(C=y.errors)&&void 0!==C&&null!==(M=C[0])&&void 0!==M&&null!==(j=M.errors)&&void 0!==j&&j[0]?Te.data.errors[0].errors[0]:null===Te||void 0===Te||null===(A=Te.data)||void 0===A?void 0:A.message})]})]})]})}}}]);
//# sourceMappingURL=448.20bc7934.chunk.js.map